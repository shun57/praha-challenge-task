# データベース設計のアンチパターンを学ぶ1

[課題](https://airtable.com/appPxhCPFYGqqN9YU/tblVlFr2q4lIqDKYc/viwX8r6DpCRp80swL/recxcD9MBY0dHPeED?blocks=hide)

## 課題1

1. 無限にタグを持ちたい場合やタグ名の長さによって、文字数の制限が出てきてしまう
2. タグ名を変更・削除したいという場合に、全てのデータの書き換えが必要になる
3. タグの順番を並び替えて表示したいという場合に、アプリ側のロジックが大変
4. タグ名の中にカンマが入った場合に意図通りの結果とならない
5. 各タグの使われている数を集計したい等、検索したい場合にSQL・アプリ側のロジックが大変
6. 検索したい場合にインデックスを利用できない

# 課題2

[ダイアグラム](https://dbdiagram.io/d/61a1e7738c901501c0d4eec9)

## 別テーブルに持たせて、タグを独立させる

- いくらでもタグをつけられる
- タグ名の登録・変更・削除はtagsテーブルだけでOK
- 順番の制御も可能
- カンマが入っても大丈夫、タグ名のバリデーションもかけ易い
- SQLのセレクトもやり易い
- インデックスもかけられる

# 課題3

## アンチパターン例

1. 音楽配信サイトで音楽のジャンルを持たせたいので、「音楽」テーブルに「ジャンル」カラムを持たせてカンマ区切りでジャンル名を入れるようにした。
2. イベント作成・募集サイトで、イベントのカテゴリを持たせるために「イベント」テーブルと「カテゴリ」テーブルを作った。「イベント」テーブルに「カテゴリIDs」カラムを作ってカンマ区切りで「カテゴリ」テーブルのidをカンマ区切りで入れるようにした。

## 参照情報

[SQLアンチパターン勉強会　第一回：ジェイウォーク](https://qiita.com/aconit96/items/24f790662d9b88a3ab74)  

